{"version":3,"sources":["components/AddTenancy.tsx"],"names":["AddTenancy","hideModal","dispatch","useContext","TenancyContext","useState","is_loading","setIsLoading","is_saving","setIsSaving","picked_tenancy","setPickedTenancy","options","setOptions","show","onHide","onSubmit","event","preventDefault","stopPropagation","addTenancyToStorage","then","data","type","ADD_TENANCY","payload","catch","err","console","log","Header","Title","Body","filterBy","id","isLoading","labelKey","minLength","onSearch","query","getAddressInfoFromDAWA","success","fail","onChange","pick","placeholder","renderMenuItemChildren","option","tekst","Footer","variant","onClick","disabled","animation","role","size","className"],"mappings":"oMA+GeA,UAjGI,SAAC,GAAoC,IAAlCC,EAAiC,EAAjCA,UACZC,EAAaC,qBAAWC,KAAxBF,SAD6C,EAGlBG,oBAAS,GAHS,mBAG9CC,EAH8C,KAGlCC,EAHkC,OAIpBF,oBAAS,GAJW,mBAI9CG,EAJ8C,KAInCC,EAJmC,OAMVJ,qBANU,mBAM9CK,EAN8C,KAM9BC,EAN8B,OAOvBN,mBAAoB,IAPG,mBAO9CO,EAP8C,KAOrCC,EAPqC,KAoDrD,OACE,cAAC,IAAD,CAAOC,MAAM,EAAMC,OAAQd,EAA3B,SACE,eAAC,IAAD,CAAMe,SA1BW,SAACC,GACpBA,EAAMC,iBACND,EAAME,kBACFT,IACFD,GAAY,GACZW,YAAoBV,GACjBW,MAAK,SAACC,GACLpB,EAAS,CACPqB,KAAMC,IACNC,QAASH,IAGXb,GAAY,GACZR,OAEDyB,OAAM,SAACC,GACNlB,GAAY,GACZmB,QAAQC,IAAIF,QAShB,UACE,cAAC,IAAMG,OAAP,UACE,cAAC,IAAMC,MAAP,gCAEF,eAAC,IAAMC,KAAP,iDAEE,cAAC,IAAD,CACEC,SAXO,kBAAM,GAYbC,GAAG,kBACHC,UAAW7B,EACX8B,SAAS,QACTC,UAAW,EACXC,SAzDW,SAACC,GACpBhC,GAAa,GACbiC,YAAuB,CACrBD,QACAE,QAAS,SAACnB,GACRT,EAAWS,GACXf,GAAa,IAEfmC,KAAM,SAACf,GACLpB,GAAa,GACbqB,QAAQC,IAAIF,OAgDRgB,SA3CgB,SAACC,GACzBjC,EAAiBiC,EAAK,KA2CdhC,QAASA,EACTiC,YAAY,2BACZC,uBAAwB,SAACC,GAAD,OAAqB,+BAAOA,EAAOC,cAG/D,eAAC,IAAMC,OAAP,WACE,cAAC,IAAD,CAAQC,QAAQ,YAAYC,QAASlD,EAArC,mBAGA,eAAC,IAAD,CACEiD,QAASxC,EAAiB,UAAY,YACtCa,KAAK,SACL6B,UAAW1C,GAAkBF,EAH/B,UAKGA,GACC,qCACE,cAAC,IAAD,CAAS6C,UAAU,SAASC,KAAK,SAASC,KAAK,KAA/C,SACE,sBAAMC,UAAU,UAAhB,0BACS,IAHb,gBAOAhD,GAAa","file":"static/js/4.3bda7e0b.chunk.js","sourcesContent":["import React, { useState, useContext } from 'react'\nimport Modal from 'react-bootstrap/Modal'\nimport Button from 'react-bootstrap/Button'\nimport Spinner from 'react-bootstrap/Spinner'\nimport Form from 'react-bootstrap/Form'\nimport { addTenancyToStorage, getAddressInfoFromDAWA } from '../lib/backend'\nimport { Tenancy } from '../types/global'\nimport { AsyncTypeahead } from 'react-bootstrap-typeahead'\nimport { ADD_TENANCY, TenancyContext } from '../contexts/TenancyContext'\n\ntype AddTenancyProps = {\n  hideModal: () => void\n}\n\nconst AddTenancy = ({ hideModal }: AddTenancyProps) => {\n  const { dispatch } = useContext(TenancyContext)\n\n  const [is_loading, setIsLoading] = useState(false)\n  const [is_saving, setIsSaving] = useState(false)\n\n  const [picked_tenancy, setPickedTenancy] = useState<Tenancy>()\n  const [options, setOptions] = useState<Tenancy[]>([])\n\n  const handleSearch = (query: string) => {\n    setIsLoading(true)\n    getAddressInfoFromDAWA({\n      query,\n      success: (data) => {\n        setOptions(data)\n        setIsLoading(false)\n      },\n      fail: (err) => {\n        setIsLoading(false)\n        console.log(err)\n      },\n    })\n  }\n\n  const handleTenancyPick = (pick: Tenancy[]) => {\n    setPickedTenancy(pick[0])\n  }\n\n  const handleSubmit = (event: React.FormEvent<HTMLFormElement>): void => {\n    event.preventDefault()\n    event.stopPropagation()\n    if (picked_tenancy) {\n      setIsSaving(true)\n      addTenancyToStorage(picked_tenancy)\n        .then((data) => {\n          dispatch({\n            type: ADD_TENANCY,\n            payload: data,\n          })\n\n          setIsSaving(false)\n          hideModal()\n        })\n        .catch((err) => {\n          setIsSaving(false)\n          console.log(err)\n        })\n    }\n  }\n\n  const filterBy = () => true\n\n  return (\n    <Modal show={true} onHide={hideModal}>\n      <Form onSubmit={handleSubmit}>\n        <Modal.Header>\n          <Modal.Title>Add new Tenancy</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          Start typing to fetch address info:\n          <AsyncTypeahead\n            filterBy={filterBy}\n            id=\"async-tenancies\"\n            isLoading={is_loading}\n            labelKey=\"tekst\"\n            minLength={3}\n            onSearch={handleSearch}\n            onChange={handleTenancyPick}\n            options={options}\n            placeholder=\"Search for an address...\"\n            renderMenuItemChildren={(option: Tenancy) => <span>{option.tekst}</span>}\n          />\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant=\"secondary\" onClick={hideModal}>\n            Close\n          </Button>\n          <Button\n            variant={picked_tenancy ? 'primary' : 'secondary'}\n            type=\"submit\"\n            disabled={!picked_tenancy || is_saving}\n          >\n            {is_saving && (\n              <>\n                <Spinner animation=\"border\" role=\"status\" size=\"sm\">\n                  <span className=\"sr-only\">Loading...</span>\n                </Spinner>{' '}\n                ...saving\n              </>\n            )}\n            {!is_saving && 'Save Changes'}\n          </Button>\n        </Modal.Footer>\n      </Form>\n    </Modal>\n  )\n}\nexport default AddTenancy\n"],"sourceRoot":""}